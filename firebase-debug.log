[debug] [2025-05-03T13:18:55.410Z] ----------------------------------------------------------------------
[debug] [2025-05-03T13:18:55.411Z] Command:       /Users/ulrikhaland/.nvm/versions/node/v20.17.0/bin/node /Users/ulrikhaland/.nvm/versions/node/v20.17.0/bin/firebase deploy --only functions
[debug] [2025-05-03T13:18:55.412Z] CLI Version:   13.22.1
[debug] [2025-05-03T13:18:55.412Z] Platform:      darwin
[debug] [2025-05-03T13:18:55.412Z] Node Version:  v20.17.0
[debug] [2025-05-03T13:18:55.412Z] Time:          Sat May 03 2025 15:18:55 GMT+0200 (Central European Summer Time)
[debug] [2025-05-03T13:18:55.412Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-05-03T13:18:55.450Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-05-03T13:18:55.450Z] > authorizing via signed-in user (ulrikhaaland2@gmail.com)
[debug] [2025-05-03T13:18:55.450Z] [iam] checking project musco-dc111 for permissions ["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]
[debug] [2025-05-03T13:18:55.451Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:18:55.451Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:18:55.452Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/musco-dc111:testIamPermissions [none]
[debug] [2025-05-03T13:18:55.452Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/musco-dc111:testIamPermissions x-goog-quota-user=projects/musco-dc111
[debug] [2025-05-03T13:18:55.452Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/musco-dc111:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2025-05-03T13:18:56.188Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/musco-dc111:testIamPermissions 200
[debug] [2025-05-03T13:18:56.188Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/musco-dc111:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2025-05-03T13:18:56.189Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:18:56.189Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:18:56.189Z] >>> [apiv2][query] POST https://iam.googleapis.com/v1/projects/musco-dc111/serviceAccounts/musco-dc111@appspot.gserviceaccount.com:testIamPermissions [none]
[debug] [2025-05-03T13:18:56.189Z] >>> [apiv2][body] POST https://iam.googleapis.com/v1/projects/musco-dc111/serviceAccounts/musco-dc111@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[debug] [2025-05-03T13:18:56.895Z] <<< [apiv2][status] POST https://iam.googleapis.com/v1/projects/musco-dc111/serviceAccounts/musco-dc111@appspot.gserviceaccount.com:testIamPermissions 404
[debug] [2025-05-03T13:18:56.895Z] <<< [apiv2][body] POST https://iam.googleapis.com/v1/projects/musco-dc111/serviceAccounts/musco-dc111@appspot.gserviceaccount.com:testIamPermissions {"error":{"code":404,"message":"Unknown service account","status":"NOT_FOUND"}}
[debug] [2025-05-03T13:18:56.896Z] [functions] service account IAM check errored, deploy may fail: HTTP Error: 404, Unknown service account {"name":"FirebaseError","children":[],"context":{"body":{"error":{"code":404,"message":"Unknown service account","status":"NOT_FOUND"}},"response":{"statusCode":404}},"exit":1,"message":"HTTP Error: 404, Unknown service account","status":404}
[info] 
[info] === Deploying to 'musco-dc111'...
[info] 
[info] i  deploying functions 
[info] Running command: npm --prefix "$RESOURCE_DIR" run lint
[info] Running command: npm --prefix "$RESOURCE_DIR" run build
[info] ✔  functions: Finished running predeploy script. 
[debug] [2025-05-03T13:19:01.616Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:01.616Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:01.616Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/musco-dc111 [none]
[debug] [2025-05-03T13:19:01.953Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/musco-dc111 200
[debug] [2025-05-03T13:19:01.953Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/musco-dc111 {"projectId":"musco-dc111","projectNumber":"1084458794272","displayName":"musco","name":"projects/musco-dc111","resources":{"hostingSite":"musco-dc111"},"state":"ACTIVE","etag":"1_1dfe5a59-c9a6-4b3c-b003-240660632792"}
[info] i  functions: preparing codebase default for deployment 
[info] i  functions: ensuring required API cloudfunctions.googleapis.com is enabled... 
[debug] [2025-05-03T13:19:01.955Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:01.955Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:01.955Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:01.955Z] Checked if tokens are valid: true, expires at: 1746281472783
[info] i  functions: ensuring required API cloudbuild.googleapis.com is enabled... 
[debug] [2025-05-03T13:19:01.955Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:01.955Z] Checked if tokens are valid: true, expires at: 1746281472783
[info] i  artifactregistry: ensuring required API artifactregistry.googleapis.com is enabled... 
[debug] [2025-05-03T13:19:01.956Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:01.956Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:01.956Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/cloudfunctions.googleapis.com [none]
[debug] [2025-05-03T13:19:01.956Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/cloudfunctions.googleapis.com x-goog-quota-user=projects/musco-dc111
[debug] [2025-05-03T13:19:01.957Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/runtimeconfig.googleapis.com [none]
[debug] [2025-05-03T13:19:01.957Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/runtimeconfig.googleapis.com x-goog-quota-user=projects/musco-dc111
[debug] [2025-05-03T13:19:01.958Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/cloudbuild.googleapis.com [none]
[debug] [2025-05-03T13:19:01.958Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/cloudbuild.googleapis.com x-goog-quota-user=projects/musco-dc111
[debug] [2025-05-03T13:19:01.958Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/artifactregistry.googleapis.com [none]
[debug] [2025-05-03T13:19:01.959Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/artifactregistry.googleapis.com x-goog-quota-user=projects/musco-dc111
[debug] [2025-05-03T13:19:02.967Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/cloudbuild.googleapis.com 200
[debug] [2025-05-03T13:19:02.968Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/cloudbuild.googleapis.com [omitted]
[info] ✔  functions: required API cloudbuild.googleapis.com is enabled 
[debug] [2025-05-03T13:19:02.968Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/runtimeconfig.googleapis.com 200
[debug] [2025-05-03T13:19:02.968Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/runtimeconfig.googleapis.com [omitted]
[debug] [2025-05-03T13:19:02.969Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/cloudfunctions.googleapis.com 200
[debug] [2025-05-03T13:19:02.969Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/cloudfunctions.googleapis.com [omitted]
[info] ✔  functions: required API cloudfunctions.googleapis.com is enabled 
[debug] [2025-05-03T13:19:02.970Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/artifactregistry.googleapis.com 200
[debug] [2025-05-03T13:19:02.970Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/artifactregistry.googleapis.com [omitted]
[info] ✔  artifactregistry: required API artifactregistry.googleapis.com is enabled 
[debug] [2025-05-03T13:19:02.970Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:02.970Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:02.971Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/musco-dc111/adminSdkConfig [none]
[debug] [2025-05-03T13:19:03.474Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/musco-dc111/adminSdkConfig 200
[debug] [2025-05-03T13:19:03.474Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/musco-dc111/adminSdkConfig {"projectId":"musco-dc111","storageBucket":"musco-dc111.firebasestorage.app"}
[debug] [2025-05-03T13:19:03.475Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:03.475Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:03.475Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/musco-dc111/configs [none]
[debug] [2025-05-03T13:19:04.427Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/musco-dc111/configs 200
[debug] [2025-05-03T13:19:04.428Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/musco-dc111/configs {"configs":[{"name":"projects/musco-dc111/configs/environment"}]}
[debug] [2025-05-03T13:19:04.429Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:04.429Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:04.429Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/musco-dc111/configs/environment/variables [none]
[debug] [2025-05-03T13:19:05.306Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/musco-dc111/configs/environment/variables 200
[debug] [2025-05-03T13:19:05.306Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/musco-dc111/configs/environment/variables {"variables":[{"name":"projects/musco-dc111/configs/environment/variables/allowed_origins","updateTime":"2025-04-24T09:38:10.202727148Z"}]}
[debug] [2025-05-03T13:19:05.307Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:05.307Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:05.307Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/musco-dc111/configs/environment/variables/allowed_origins [none]
[debug] [2025-05-03T13:19:06.196Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/musco-dc111/configs/environment/variables/allowed_origins 200
[debug] [2025-05-03T13:19:06.196Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/musco-dc111/configs/environment/variables/allowed_origins {"name":"projects/musco-dc111/configs/environment/variables/allowed_origins","updateTime":"2025-04-24T09:38:10.202727148Z","text":"http://localhost:3000,https://bodai.no,https://www.bodai.no,https://musco-one.vercel.app,https://musco-cakqufmza-zone2lab.vercel.app"}
[debug] [2025-05-03T13:19:06.199Z] Validating nodejs source
[warn] ⚠  functions: Runtime Node.js 18 was deprecated on 2025-04-30 and will be decommissioned on 2025-10-31, after which you will not be able to deploy without upgrading. Consider upgrading now to avoid disruption. See https://cloud.google.com/functions/docs/runtime-support for full details on the lifecycle policy 
[debug] [2025-05-03T13:19:06.563Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "lib/index.js",
  "dependencies": {
    "firebase-admin": "^13.3.0",
    "firebase-functions": "^6.0.1",
    "resend": "^4.4.0"
  },
  "devDependencies": {
    "@babel/eslint-parser": "^7.27.0",
    "@typescript-eslint/eslint-plugin": "^8.31.0",
    "@typescript-eslint/parser": "^8.31.0",
    "eslint": "^8.57.1",
    "eslint-config-google": "^0.14.0",
    "eslint-plugin-import": "^2.25.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^5.8.3"
  },
  "private": true
}
[debug] [2025-05-03T13:19:06.563Z] Building nodejs source
[info] i  functions: Loading and analyzing source code for codebase default to determine what to deploy 
[debug] [2025-05-03T13:19:06.564Z] Could not find functions.yaml. Must use http discovery
[debug] [2025-05-03T13:19:06.568Z] Found firebase-functions binary at '/Users/ulrikhaland/Documents/musco-new/functions/node_modules/.bin/firebase-functions'
[info] Serving at port 8605

[debug] [2025-05-03T13:19:06.886Z] Got response from /__/functions.yaml {"endpoints":{"sendLoginEmail":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"sendLoginEmail"},"validateAuthCode":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"validateAuthCode"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{},"params":[{"name":"RESEND_API_KEY","type":"string"},{"name":"DYNAMIC_LINK_DOMAIN","type":"string"},{"name":"EMAIL_FROM_ADDRESS","type":"string","default":"noreply@bodai.no"},{"name":"ALLOWED_ORIGINS","type":"string","default":"http://localhost:3000,https://bodai.no,https://www.bodai.no,https://musco-one.vercel.app,https://musco-cakqufmza-zone2lab.vercel.app"}]}
[info] i  extensions: ensuring required API firebaseextensions.googleapis.com is enabled... 
[debug] [2025-05-03T13:19:11.906Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:11.906Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:11.906Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/firebaseextensions.googleapis.com [none]
[debug] [2025-05-03T13:19:11.906Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/firebaseextensions.googleapis.com x-goog-quota-user=projects/musco-dc111
[debug] [2025-05-03T13:19:12.891Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/firebaseextensions.googleapis.com 200
[debug] [2025-05-03T13:19:12.892Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/firebaseextensions.googleapis.com [omitted]
[info] ✔  extensions: required API firebaseextensions.googleapis.com is enabled 
[debug] [2025-05-03T13:19:12.892Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-05-03T13:19:12.892Z] > authorizing via signed-in user (ulrikhaaland2@gmail.com)
[debug] [2025-05-03T13:19:12.892Z] [iam] checking project musco-dc111 for permissions ["firebase.projects.get","firebaseextensions.instances.list"]
[debug] [2025-05-03T13:19:12.892Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:12.892Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:12.893Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/musco-dc111:testIamPermissions [none]
[debug] [2025-05-03T13:19:12.893Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/musco-dc111:testIamPermissions x-goog-quota-user=projects/musco-dc111
[debug] [2025-05-03T13:19:12.893Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/musco-dc111:testIamPermissions {"permissions":["firebase.projects.get","firebaseextensions.instances.list"]}
[debug] [2025-05-03T13:19:13.619Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/musco-dc111:testIamPermissions 200
[debug] [2025-05-03T13:19:13.619Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/musco-dc111:testIamPermissions {"permissions":["firebase.projects.get","firebaseextensions.instances.list"]}
[debug] [2025-05-03T13:19:13.620Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:13.620Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:13.620Z] >>> [apiv2][query] GET https://firebaseextensions.googleapis.com/v1beta/projects/musco-dc111/instances pageSize=100&pageToken=
[debug] [2025-05-03T13:19:14.562Z] <<< [apiv2][status] GET https://firebaseextensions.googleapis.com/v1beta/projects/musco-dc111/instances 200
[debug] [2025-05-03T13:19:14.563Z] <<< [apiv2][body] GET https://firebaseextensions.googleapis.com/v1beta/projects/musco-dc111/instances {}
[info] i  functions: Loaded environment variables from .env.musco-dc111. 
[info] i  functions: preparing functions directory for uploading... 
[info] i  functions: packaged /Users/ulrikhaland/Documents/musco-new/functions (101.66 KB) for uploading 
[debug] [2025-05-03T13:19:14.603Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:14.603Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:14.603Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v1/projects/musco-dc111/locations/-/functions [none]
[debug] [2025-05-03T13:19:15.431Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v1/projects/musco-dc111/locations/-/functions 200
[debug] [2025-05-03T13:19:15.431Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v1/projects/musco-dc111/locations/-/functions {}
[debug] [2025-05-03T13:19:15.432Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:15.432Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:15.432Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/musco-dc111/locations/-/functions filter=environment%3D%22GEN_2%22
[debug] [2025-05-03T13:19:16.532Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/musco-dc111/locations/-/functions 200
[debug] [2025-05-03T13:19:16.533Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/musco-dc111/locations/-/functions {"functions":[{"name":"projects/musco-dc111/locations/us-central1/functions/sendLoginEmail","buildConfig":{"build":"projects/1084458794272/locations/us-central1/builds/f781e6bd-72ff-447b-af17-6f07bae9c786","runtime":"nodejs18","entryPoint":"sendLoginEmail","source":{"storageSource":{"bucket":"gcf-v2-sources-1084458794272-us-central1","object":"sendLoginEmail/function-source.zip","generation":"1745494557215840"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/musco-dc111/locations/us-central1/repositories/gcf-artifacts","sourceProvenance":{"resolvedStorageSource":{"bucket":"gcf-v2-sources-1084458794272-us-central1","object":"sendLoginEmail/function-source.zip","generation":"1745494557215840"}},"dockerRegistry":"ARTIFACT_REGISTRY","serviceAccount":"projects/musco-dc111/serviceAccounts/1084458794272-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/musco-dc111/locations/us-central1/services/sendloginemail","timeoutSeconds":60,"environmentVariables":{"RESEND_API_KEY":"re_h4S7TWqJ_63xzUJ1UsPLjGDLkKwg1CaR2","APP_BASE_URL":"https://bodai.no","DYNAMIC_LINK_DOMAIN":"","EMAIL_FROM_ADDRESS":"noreply@bodai.no","ALLOWED_ORIGINS":"http://localhost:3000,https://bodai.no,https://www.bodai.no,https://musco-one.vercel.app,https://musco-cakqufmza-zone2lab.vercel.app","FIREBASE_CONFIG":"{\"projectId\":\"musco-dc111\",\"storageBucket\":\"musco-dc111.firebasestorage.app\"}","GCLOUD_PROJECT":"musco-dc111","EVENTARC_CLOUD_EVENT_SOURCE":"projects/musco-dc111/locations/us-central1/services/sendLoginEmail","FUNCTION_TARGET":"sendLoginEmail","LOG_EXECUTION_ID":"true"},"maxInstanceCount":3,"ingressSettings":"ALLOW_ALL","uri":"https://sendloginemail-latacasvlq-uc.a.run.app","serviceAccountEmail":"1084458794272-compute@developer.gserviceaccount.com","availableMemory":"256Mi","allTrafficOnLatestRevision":true,"revision":"sendloginemail-00007-foc","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"ACTIVE","updateTime":"2025-04-24T11:36:53.604691384Z","labels":{"deployment-callable":"true","firebase-functions-hash":"ba08e442292a4b3eb915e28f03b3a2e85326eeaf","deployment-tool":"cli-firebase"},"environment":"GEN_2","url":"https://us-central1-musco-dc111.cloudfunctions.net/sendLoginEmail","createTime":"2025-04-24T09:44:25.833309535Z","satisfiesPzi":true}]}
[info] i  functions: ensuring required API run.googleapis.com is enabled... 
[debug] [2025-05-03T13:19:16.535Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:16.535Z] Checked if tokens are valid: true, expires at: 1746281472783
[info] i  functions: ensuring required API eventarc.googleapis.com is enabled... 
[debug] [2025-05-03T13:19:16.535Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:16.535Z] Checked if tokens are valid: true, expires at: 1746281472783
[info] i  functions: ensuring required API pubsub.googleapis.com is enabled... 
[debug] [2025-05-03T13:19:16.535Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:16.535Z] Checked if tokens are valid: true, expires at: 1746281472783
[info] i  functions: ensuring required API storage.googleapis.com is enabled... 
[debug] [2025-05-03T13:19:16.535Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:16.535Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:16.535Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/run.googleapis.com [none]
[debug] [2025-05-03T13:19:16.535Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/run.googleapis.com x-goog-quota-user=projects/musco-dc111
[debug] [2025-05-03T13:19:16.536Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/eventarc.googleapis.com [none]
[debug] [2025-05-03T13:19:16.536Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/eventarc.googleapis.com x-goog-quota-user=projects/musco-dc111
[debug] [2025-05-03T13:19:16.538Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/pubsub.googleapis.com [none]
[debug] [2025-05-03T13:19:16.538Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/pubsub.googleapis.com x-goog-quota-user=projects/musco-dc111
[debug] [2025-05-03T13:19:16.539Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/storage.googleapis.com [none]
[debug] [2025-05-03T13:19:16.539Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/storage.googleapis.com x-goog-quota-user=projects/musco-dc111
[debug] [2025-05-03T13:19:17.434Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/pubsub.googleapis.com 200
[debug] [2025-05-03T13:19:17.434Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/pubsub.googleapis.com [omitted]
[info] ✔  functions: required API pubsub.googleapis.com is enabled 
[debug] [2025-05-03T13:19:17.435Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/eventarc.googleapis.com 200
[debug] [2025-05-03T13:19:17.435Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/eventarc.googleapis.com [omitted]
[info] ✔  functions: required API eventarc.googleapis.com is enabled 
[debug] [2025-05-03T13:19:17.436Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/run.googleapis.com 200
[debug] [2025-05-03T13:19:17.437Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/run.googleapis.com [omitted]
[info] ✔  functions: required API run.googleapis.com is enabled 
[debug] [2025-05-03T13:19:17.438Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/storage.googleapis.com 200
[debug] [2025-05-03T13:19:17.438Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/musco-dc111/services/storage.googleapis.com [omitted]
[info] ✔  functions: required API storage.googleapis.com is enabled 
[info] i  functions: generating the service identity for pubsub.googleapis.com... 
[debug] [2025-05-03T13:19:17.439Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:17.439Z] Checked if tokens are valid: true, expires at: 1746281472783
[info] i  functions: generating the service identity for eventarc.googleapis.com... 
[debug] [2025-05-03T13:19:17.439Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:17.439Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:17.439Z] >>> [apiv2][query] POST https://serviceusage.googleapis.com/v1beta1/projects/1084458794272/services/pubsub.googleapis.com:generateServiceIdentity [none]
[debug] [2025-05-03T13:19:17.439Z] >>> [apiv2][query] POST https://serviceusage.googleapis.com/v1beta1/projects/1084458794272/services/eventarc.googleapis.com:generateServiceIdentity [none]
[debug] [2025-05-03T13:19:17.831Z] <<< [apiv2][status] POST https://serviceusage.googleapis.com/v1beta1/projects/1084458794272/services/eventarc.googleapis.com:generateServiceIdentity 200
[debug] [2025-05-03T13:19:17.832Z] <<< [apiv2][body] POST https://serviceusage.googleapis.com/v1beta1/projects/1084458794272/services/eventarc.googleapis.com:generateServiceIdentity {"name":"operations/finished.DONE_OPERATION","done":true,"response":{"@type":"type.googleapis.com/google.api.serviceusage.v1beta1.ServiceIdentity","email":"service-1084458794272@gcp-sa-eventarc.iam.gserviceaccount.com","uniqueId":"108128622036870707275"}}
[debug] [2025-05-03T13:19:18.350Z] <<< [apiv2][status] POST https://serviceusage.googleapis.com/v1beta1/projects/1084458794272/services/pubsub.googleapis.com:generateServiceIdentity 200
[debug] [2025-05-03T13:19:18.350Z] <<< [apiv2][body] POST https://serviceusage.googleapis.com/v1beta1/projects/1084458794272/services/pubsub.googleapis.com:generateServiceIdentity {"name":"operations/finished.DONE_OPERATION","done":true,"response":{"@type":"type.googleapis.com/google.api.serviceusage.v1beta1.ServiceIdentity","email":"service-1084458794272@gcp-sa-pubsub.iam.gserviceaccount.com","uniqueId":"116138625822808422071"}}
[debug] [2025-05-03T13:19:18.353Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:18.353Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:18.353Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/musco-dc111 [none]
[debug] [2025-05-03T13:19:18.632Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/musco-dc111 200
[debug] [2025-05-03T13:19:18.632Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/musco-dc111 {"projectId":"musco-dc111","projectNumber":"1084458794272","displayName":"musco","name":"projects/musco-dc111","resources":{"hostingSite":"musco-dc111"},"state":"ACTIVE","etag":"1_1dfe5a59-c9a6-4b3c-b003-240660632792"}
[debug] [2025-05-03T13:19:18.633Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:18.633Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:18.633Z] >>> [apiv2][query] GET https://cloudbilling.googleapis.com/v1/projects/musco-dc111/billingInfo [none]
[debug] [2025-05-03T13:19:19.495Z] <<< [apiv2][status] GET https://cloudbilling.googleapis.com/v1/projects/musco-dc111/billingInfo 200
[debug] [2025-05-03T13:19:19.495Z] <<< [apiv2][body] GET https://cloudbilling.googleapis.com/v1/projects/musco-dc111/billingInfo {"name":"projects/musco-dc111/billingInfo","projectId":"musco-dc111","billingAccountName":"billingAccounts/01AF99-69253D-2DC18C","billingEnabled":true}
[debug] [2025-05-03T13:19:19.496Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:19.496Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:19.497Z] >>> [apiv2][query] POST https://cloudfunctions.googleapis.com/v2/projects/musco-dc111/locations/us-central1/functions:generateUploadUrl [none]
[debug] [2025-05-03T13:19:20.789Z] <<< [apiv2][status] POST https://cloudfunctions.googleapis.com/v2/projects/musco-dc111/locations/us-central1/functions:generateUploadUrl 200
[debug] [2025-05-03T13:19:20.789Z] <<< [apiv2][body] POST https://cloudfunctions.googleapis.com/v2/projects/musco-dc111/locations/us-central1/functions:generateUploadUrl {"uploadUrl":"https://storage.googleapis.com/gcf-v2-uploads-1084458794272.us-central1.cloudfunctions.appspot.com/6c5e06b6-1d34-49e6-a005-4893652cef54.zip?GoogleAccessId=service-1084458794272@gcf-admin-robot.iam.gserviceaccount.com&Expires=1746280160&Signature=Erl5afmySL8z5j6l210CBjRHcxElDXcGtBU5C3qQvVeYaRbjk%2FUJ%2FC6j0pr%2FkT1qe73ToxtR8eUBqVJcaD59jp7sVvBhvNdBLlefEcfjVyfc96bXi9cU6ExLl0MgzLdpLOkUHzDVAsPt4FI8pca5h8FzXAQwUWL3o2DQwilTqriYcQX8DVuAUzr6MZuFAGcJ3hHCqv0m0Xn2iUaqLZs%2FKj8FZqWsE7dKPRNlZVwG%2BVc0qkhwOlaNzDN54%2FWsNzJ9%2FlkUyPUipP5kSwJbZ8%2BnZJ76XnAQ1dSyF8jkhie5PDLSjDZFfSRfOpnE2MAo%2Fjm3kS4Qx2cXl8CMc49MJ0Ea1g%3D%3D","storageSource":{"bucket":"gcf-v2-uploads-1084458794272.us-central1.cloudfunctions.appspot.com","object":"6c5e06b6-1d34-49e6-a005-4893652cef54.zip"}}
[debug] [2025-05-03T13:19:20.791Z] >>> [apiv2][query] PUT https://storage.googleapis.com/gcf-v2-uploads-1084458794272.us-central1.cloudfunctions.appspot.com/6c5e06b6-1d34-49e6-a005-4893652cef54.zip GoogleAccessId=service-1084458794272%40gcf-admin-robot.iam.gserviceaccount.com&Expires=1746280160&Signature=Erl5afmySL8z5j6l210CBjRHcxElDXcGtBU5C3qQvVeYaRbjk%2FUJ%2FC6j0pr%2FkT1qe73ToxtR8eUBqVJcaD59jp7sVvBhvNdBLlefEcfjVyfc96bXi9cU6ExLl0MgzLdpLOkUHzDVAsPt4FI8pca5h8FzXAQwUWL3o2DQwilTqriYcQX8DVuAUzr6MZuFAGcJ3hHCqv0m0Xn2iUaqLZs%2FKj8FZqWsE7dKPRNlZVwG%2BVc0qkhwOlaNzDN54%2FWsNzJ9%2FlkUyPUipP5kSwJbZ8%2BnZJ76XnAQ1dSyF8jkhie5PDLSjDZFfSRfOpnE2MAo%2Fjm3kS4Qx2cXl8CMc49MJ0Ea1g%3D%3D
[debug] [2025-05-03T13:19:20.791Z] >>> [apiv2][body] PUT https://storage.googleapis.com/gcf-v2-uploads-1084458794272.us-central1.cloudfunctions.appspot.com/6c5e06b6-1d34-49e6-a005-4893652cef54.zip [stream]
[debug] [2025-05-03T13:19:22.062Z] <<< [apiv2][status] PUT https://storage.googleapis.com/gcf-v2-uploads-1084458794272.us-central1.cloudfunctions.appspot.com/6c5e06b6-1d34-49e6-a005-4893652cef54.zip 200
[debug] [2025-05-03T13:19:22.062Z] <<< [apiv2][body] PUT https://storage.googleapis.com/gcf-v2-uploads-1084458794272.us-central1.cloudfunctions.appspot.com/6c5e06b6-1d34-49e6-a005-4893652cef54.zip [omitted]
[info] ✔  functions: functions folder uploaded successfully 
[info] i  functions: creating Node.js 18 (2nd Gen) function validateAuthCode(us-central1)... 
[info] i  functions: updating Node.js 18 (2nd Gen) function sendLoginEmail(us-central1)... 
[debug] [2025-05-03T13:19:22.067Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:22.067Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:22.067Z] >>> [apiv2][query] POST https://cloudfunctions.googleapis.com/v2/projects/musco-dc111/locations/us-central1/functions functionId=validateAuthCode
[debug] [2025-05-03T13:19:22.067Z] >>> [apiv2][body] POST https://cloudfunctions.googleapis.com/v2/projects/musco-dc111/locations/us-central1/functions {"name":"projects/musco-dc111/locations/us-central1/functions/validateAuthCode","buildConfig":{"runtime":"nodejs18","entryPoint":"validateAuthCode","source":{"storageSource":{"bucket":"gcf-v2-uploads-1084458794272.us-central1.cloudfunctions.appspot.com","object":"6c5e06b6-1d34-49e6-a005-4893652cef54.zip"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""}},"serviceConfig":{"environmentVariables":{"RESEND_API_KEY":"re_h4S7TWqJ_63xzUJ1UsPLjGDLkKwg1CaR2","APP_BASE_URL":"https://bodai.no","DYNAMIC_LINK_DOMAIN":"","EMAIL_FROM_ADDRESS":"noreply@bodai.no","ALLOWED_ORIGINS":"http://localhost:3000,https://bodai.no,https://www.bodai.no,https://musco-one.vercel.app,https://musco-cakqufmza-zone2lab.vercel.app","FIREBASE_CONFIG":"{\"projectId\":\"musco-dc111\",\"storageBucket\":\"musco-dc111.firebasestorage.app\"}","GCLOUD_PROJECT":"musco-dc111","EVENTARC_CLOUD_EVENT_SOURCE":"projects/musco-dc111/locations/us-central1/services/validateAuthCode","FUNCTION_TARGET":"validateAuthCode"},"ingressSettings":null,"timeoutSeconds":null,"serviceAccountEmail":null,"availableMemory":"256Mi","minInstanceCount":null,"maxInstanceCount":null,"maxInstanceRequestConcurrency":80,"availableCpu":"1","vpcConnector":null,"vpcConnectorEgressSettings":null},"labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"3b3f7e23d7d544abe9eb711960f5f42371d50738"}}
[debug] [2025-05-03T13:19:23.443Z] <<< [apiv2][status] POST https://cloudfunctions.googleapis.com/v2/projects/musco-dc111/locations/us-central1/functions 200
[debug] [2025-05-03T13:19:23.444Z] <<< [apiv2][body] POST https://cloudfunctions.googleapis.com/v2/projects/musco-dc111/locations/us-central1/functions {"name":"projects/musco-dc111/locations/us-central1/operations/operation-1746278362847-6343b1d7f1af6-8476ab9f-9ef9b88f","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-05-03T13:19:23.390849408Z","target":"projects/musco-dc111/locations/us-central1/functions/validateAuthCode","verb":"create","cancelRequested":false,"apiVersion":"v2"},"done":false}
[debug] [2025-05-03T13:19:23.445Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:23.445Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:23.445Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/musco-dc111/locations/us-central1/operations/operation-1746278362847-6343b1d7f1af6-8476ab9f-9ef9b88f [none]
[debug] [2025-05-03T13:19:23.655Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/musco-dc111/locations/us-central1/operations/operation-1746278362847-6343b1d7f1af6-8476ab9f-9ef9b88f 200
[debug] [2025-05-03T13:19:23.655Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/musco-dc111/locations/us-central1/operations/operation-1746278362847-6343b1d7f1af6-8476ab9f-9ef9b88f {"name":"projects/musco-dc111/locations/us-central1/operations/operation-1746278362847-6343b1d7f1af6-8476ab9f-9ef9b88f","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-05-03T13:19:23.390849408Z","target":"projects/musco-dc111/locations/us-central1/functions/validateAuthCode","verb":"create","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/musco-dc111/locations/us-central1/functions/validateAuthCode","buildConfig":{"runtime":"nodejs18","entryPoint":"validateAuthCode","source":{"storageSource":{"bucket":"gcf-v2-sources-1084458794272-us-central1","object":"validateAuthCode/function-source.zip","generation":"1746278363126644"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"serviceAccount":"projects/musco-dc111/serviceAccounts/1084458794272-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/musco-dc111/locations/us-central1/services/validateauthcode","timeoutSeconds":60,"environmentVariables":{"RESEND_API_KEY":"re_h4S7TWqJ_63xzUJ1UsPLjGDLkKwg1CaR2","APP_BASE_URL":"https://bodai.no","DYNAMIC_LINK_DOMAIN":"","EMAIL_FROM_ADDRESS":"noreply@bodai.no","ALLOWED_ORIGINS":"http://localhost:3000,https://bodai.no,https://www.bodai.no,https://musco-one.vercel.app,https://musco-cakqufmza-zone2lab.vercel.app","FIREBASE_CONFIG":"{\"projectId\":\"musco-dc111\",\"storageBucket\":\"musco-dc111.firebasestorage.app\"}","GCLOUD_PROJECT":"musco-dc111","EVENTARC_CLOUD_EVENT_SOURCE":"projects/musco-dc111/locations/us-central1/services/validateAuthCode","FUNCTION_TARGET":"validateAuthCode","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","serviceAccountEmail":"1084458794272-compute@developer.gserviceaccount.com","availableMemory":"256Mi","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"3b3f7e23d7d544abe9eb711960f5f42371d50738"},"environment":"GEN_2"},"stages":[{"name":"BUILD","state":"NOT_STARTED","stateMessages":[{"severity":"WARNING","type":"BuildAnalysisWarning","message":"Node.js 18 is no longer supported by the Node.js community as of 30 April, 2025. Node.js 18 will be deprecated on 2025-04-30. We recommend you to upgrade to the latest version of Node.js as soon as possible."}]},{"name":"SERVICE","state":"NOT_STARTED"}],"operationType":"CREATE_FUNCTION"},"done":false}
[debug] [2025-05-03T13:19:24.158Z] [create-default-us-central1-validateAuthCode] Retrying task index 0
[debug] [2025-05-03T13:19:24.158Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:24.159Z] Checked if tokens are valid: true, expires at: 1746281472783
[debug] [2025-05-03T13:19:24.159Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/musco-dc111/locations/us-central1/operations/operation-1746278362847-6343b1d7f1af6-8476ab9f-9ef9b88f [none]
